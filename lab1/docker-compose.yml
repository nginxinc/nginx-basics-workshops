version: '3.3'
services:
  # NGINX webservers with ingress-demo pages
  # NGINX OSS Proxy with tools build
  # NGINX Basics, Jan 2024
  # Chris Akker, Shouvik Dutta
  web1:
      hostname: web1
      image: nginxinc/ingress-demo
      ports:
        - "80"
        - "443"
  web2:
      hostname: web2
      image: nginxinc/ingress-demo
      ports:
        - "80"
        - "433"
  web3:
      hostname: web3
      image: nginxinc/ingress-demo
      ports:
        - "80"
        - "443"       
  nginx-oss:                  # NGINX OSS Load Balancer
      hostname: nginx-oss
      build: nginx-oss
      links:
          - web1:web1
          - web2:web2
          - web3:web3
      volumes:
          - ./nginx-oss/etc/nginx/conf.d:/etc/nginx/conf.d
          - ./nginx-oss/etc/nginx/includes:/etc/nginx/includes
          - ./nginx-oss/etc/nginx/nginx.conf:/etc/nginx/nginx.conf
      ports:
          - 9000:9000
          - 80:80
          - 443:443
      restart: always